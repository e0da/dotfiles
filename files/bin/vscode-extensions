#!/bin/bash

USAGE=1
DEFAULT_LIST="$HOME/src/dotfiles/files/vscode-extensions"
SCRIPT_NAME="$(basename $0)"

LIST=${LIST:-$DEFAULT_LIST}

_import() {
  set -x
  cat "$LIST" | while read extension; do
    code --install-extension $extension
  done
}

_export() {
  set -x
  code --list-extensions | tee "$LIST"
}

case "$1" in
  import)
    _import
    ;;
  export)
    _export
    ;;
  *)
    echo "Usage: $SCRIPT_NAME ACTION [LIST=path/to/vscode-extensions]"
    echo ""
    echo "ACTIONS"
    echo "  export - write list of installed extensions to LIST"
    echo "  import - install extensions listed in LIST"
    echo ""
    echo "LIST"
    echo "  LIST=path/to/vscode-extensions is optional, and allows you"
    echo "  to override the default LIST path of $LIST"
    exit $USAGE
    ;;
esac

:
